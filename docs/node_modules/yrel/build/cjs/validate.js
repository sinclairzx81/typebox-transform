"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.validate = void 0;
const processSchema_1 = require("./processSchema");
const getIssues = (item) => {
    return [
        ...((item.errors.length > 0) ? [{ key: item.key, errors: item.errors }] : []),
        ...item.children.reduce((total, item) => [...total, ...getIssues(item)], [])
    ];
};
const validate = (schema, data, options) => {
    const { rootKey = '' } = { ...options };
    const tree = (0, processSchema_1.processSchema)(schema, data, { key: rootKey });
    const isValid = tree.isValid;
    const result = isValid ? data : undefined;
    return { isValid, issues: getIssues(tree), data: result };
};
exports.validate = validate;
